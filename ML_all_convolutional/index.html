<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>A cross-region model with common structure at all locations &#8212; Regional cross-training in ML climate models</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinxdoc.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Generic model fixed structure" href="VAE.html" />
    <link rel="prev" title="Assemble ERA5 normalized data into a set of tf.tensors" href="../normalization/make_normalized_tensors.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="VAE.html" title="Generic model fixed structure"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../normalization/make_normalized_tensors.html" title="Assemble ERA5 normalized data into a set of tf.tensors"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">MLRXT</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">A cross-region model with common structure at all locations</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="a-cross-region-model-with-common-structure-at-all-locations">
<h1>A cross-region model with common structure at all locations<a class="headerlink" href="#a-cross-region-model-with-common-structure-at-all-locations" title="Permalink to this heading">¶</a></h1>
<p>Following <a class="reference external" href="http://brohan.org/Proxy_20CR/">previous work</a>, we will base our models on the <a class="reference external" href="https://en.wikipedia.org/wiki/Variational_autoencoder">Deep Convolutional Variational AutoEncoder (VAE)</a>. The difference from the previous work is that we want to minimize the number of parameters that are location-specific. This is to allow the model to be trained on data from one location and then used to generate data for another location.
Convolutional model layers have the useful property that they are location-independent, so this model consists entirely of convolutional layers - the dense layer that previously output the latent space vector has been replaced by additional convolutions. The weakness of this is that it reduces the ability of the model to transfer information between locations, so we add some additional convolutional layers to help with this.</p>
<figure class="align-center" id="id1" style="width: 95%">
<a class="reference internal image-reference" href="../_images/Model_structure.png"><img alt="../_images/Model_structure.png" src="../_images/Model_structure.png" style="width: 95%;" /></a>
<figcaption>
<p><span class="caption-text">The structure of the VAE used to train the generator</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>The model is explicitly designed to train on regionally-limited data. So the <a class="reference internal" href="specify.html"><span class="doc">specification file</span></a> includes a mask. Training is done only on regions indicated by the mask, but the model always calculates output for all regions. This gives us output for regions where we are using data to train, and regions where we are using no training data, separately. The default mask trains only on the Northern Hemisphere.</p>
<p>The model structure and data flows are defined in files that should not need modification:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="VAE.html">Model structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="make_dataset.html">Input Datasets</a></li>
</ul>
</div>
<p>To run the model, we need to specify the model inputs, outputs and hyperparameters. This is done in a specification file. Copy the specification file and the model training script to a new directory, and edit the specification file to suit your needs. Then run the training script.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="specify.html">Specification file</a></li>
<li class="toctree-l1"><a class="reference internal" href="training.html">Training script</a></li>
</ul>
</div>
<p>And to test the training success there are scripts for plotting the training history and for testing the model on a test dataset.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="plot_history.html">Plot training_history</a></li>
<li class="toctree-l1"><a class="reference internal" href="validation.html">Validate on single month</a></li>
<li class="toctree-l1"><a class="reference internal" href="validate_multi.html">Validate on time-series</a></li>
</ul>
</div>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/MLRXT.webp" alt="Logo"/>
            </a></p>
<h3><a href="../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../get_data/index.html">Get the training data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../normalization/index.html">Normalize the data for model fitting</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">An ML model with common structure at all locations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/index.html">Utility functions for plotting and re-gridding</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../how_to.html">How to reproduce or extend this work</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Authors and acknowledgements</a></li>
</ul>
<h3><a href="https://github.com/philip-brohan/ML_region_sharing">Get a copy</a></h3>

<ul>
    <li><a href="https://github.com/philip-brohan/ML_region_sharing" rel="nofollow">Github repository</a></li>
</ul>

<h3>Found a bug, or have a suggestion?</h3>

Please <a href="https://github.com/philip-brohan/ML_region_sharing/issues/new">raise an issue</a>.
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="VAE.html" title="Generic model fixed structure"
             >next</a> |</li>
        <li class="right" >
          <a href="../normalization/make_normalized_tensors.html" title="Assemble ERA5 normalized data into a set of tf.tensors"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">MLRXT</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">A cross-region model with common structure at all locations</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    </div>
  </body>
</html>