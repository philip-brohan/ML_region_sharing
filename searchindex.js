Search.setIndex({"docnames": ["ML_all_convolutional/VAE", "ML_all_convolutional/index", "ML_all_convolutional/make_dataset", "ML_all_convolutional/plot_history", "ML_all_convolutional/specify", "ML_all_convolutional/training", "ML_all_convolutional/validate_multi", "ML_all_convolutional/validation", "credits", "get_data/ERA5", "get_data/index", "get_data/land_mask", "how_to", "index", "normalization/estimate_parameters", "normalization/index", "normalization/make_normalized_tensors", "normalization/make_raw_tensors", "normalization/validate_for_month", "normalization/validate_for_points", "utils/grids", "utils/index", "utils/plots"], "filenames": ["ML_all_convolutional/VAE.rst", "ML_all_convolutional/index.rst", "ML_all_convolutional/make_dataset.rst", "ML_all_convolutional/plot_history.rst", "ML_all_convolutional/specify.rst", "ML_all_convolutional/training.rst", "ML_all_convolutional/validate_multi.rst", "ML_all_convolutional/validation.rst", "credits.rst", "get_data/ERA5.rst", "get_data/index.rst", "get_data/land_mask.rst", "how_to.rst", "index.rst", "normalization/estimate_parameters.rst", "normalization/index.rst", "normalization/make_normalized_tensors.rst", "normalization/make_raw_tensors.rst", "normalization/validate_for_month.rst", "normalization/validate_for_points.rst", "utils/grids.rst", "utils/index.rst", "utils/plots.rst"], "titles": ["Generic model fixed structure", "A cross-region model with common structure at all locations", "Make the tf.data.Dataset inputs and outputs for the cross-region DCVAE", "Cross-region model - plot training history", "Generic model specification file", "Cross-region model training script", "Cross-region model - validate trained model on time-series of all test months", "Cross-region model - validate trained model on test data for a single month", "Authors and acknowledgements", "ERA5 data download and access", "Get the data to be used", "Land mask download", "How to reproduce and extend this work", "Regional cross-training in ML climate models", "Estimate normalization parameters for ERA5 data", "Normalizing training data", "Assemble ERA5 normalized data into a set of tf.tensors", "Assemble ERA5 raw data into a set of tf.tensors", "Check normalization of ERA5 data", "Check gamma distributions for ERA5 data", "Define a standard grid", "Utility functions for plotting and re-gridding", "Plotting utilities"], "terms": {"text": [3, 6, 7], "thi": [0, 1, 2, 4, 5, 8, 9, 10, 11, 13, 16, 17, 20, 22], "document": [8, 12, 13], "i": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 19, 20, 22], "current": [0, 5, 8], "maintain": 8, "philip": [8, 12], "brohan": [8, 12], "metoffic": 8, "gov": 8, "uk": [8, 20], "all": [3, 4, 5, 7, 8, 9, 10, 12, 13, 14, 15, 16, 20, 22], "critic": 8, "should": [1, 4, 8, 12, 16], "direct": 8, "him": 8, "put": [8, 12], "pleas": 8, "don": [3, 5, 6, 7, 8, 9, 11, 12, 13, 22], "t": [2, 3, 5, 6, 7, 8, 9, 11, 12, 13, 22], "send": 8, "email": 8, "rais": [2, 3, 6, 7, 8, 9, 22], "an": [3, 4, 6, 7, 8, 11, 12, 13, 19, 20, 22], "issu": 8, "instead": [6, 7, 8, 20], "blame": 8, "go": [6, 7, 8, 10, 13, 14, 16, 17], "credit": 8, "more": [4, 8], "wide": 8, "distribut": [0, 4, 5, 7, 8, 13, 14, 16, 18], "wa": 8, "written": 8, "met": 8, "offic": 8, "he": 8, "support": 8, "hadlei": 8, "centr": [3, 6, 7, 8, 13, 14], "climat": [8, 10, 12], "programm": 8, "fund": 8, "bei": 8, "weather": 8, "scienc": [8, 13], "servic": 8, "partnership": 8, "wcssp": 8, "south": 8, "africa": 8, "part": [8, 13], "newton": 8, "work": [1, 5, 8, 9, 13, 20], "follow": [0, 1, 2, 4], "from": [0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 22], "previou": [1, 3, 13], "model": [2, 12, 16, 17, 20], "data": [0, 1, 3, 4, 5, 6, 8, 12, 13, 20, 22], "assimil": [], "ml": [4, 8, 12, 16, 17], "The": [1, 7, 8, 12, 13, 14, 16, 17], "tensorflow": [0, 2, 3, 4, 5, 6, 7, 8, 12, 14, 16, 17, 19], "librari": [8, 12, 16, 17, 21], "us": [0, 1, 2, 3, 4, 5, 6, 7, 8, 11, 12, 13, 14, 16, 17, 18, 19, 20], "throughout": 8, "train": [0, 1, 2, 4, 8, 16, 17], "came": 8, "era5": [2, 8, 10, 11, 12, 13, 20, 22], "reanalysi": [8, 9, 11, 22], "were": 8, "download": [8, 10, 12, 16, 17], "copernicu": [8, 10, 12], "chang": 8, "store": [8, 9, 10, 16, 17], "isambard": [7, 8, 12], "nation": 8, "tier": 8, "2": [0, 2, 3, 4, 6, 7, 8, 12, 14, 16, 18, 19, 22], "hpc": 8, "oper": [8, 13], "gw4": 8, "epsrc": 8, "ep": [0, 8], "p020224": 8, "1": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17, 18, 19, 20, 22], "benefit": 8, "ai": 8, "assist": 8, "both": [3, 6, 7, 8, 13, 16], "github": [8, 12], "copilot": 8, "chatgpt": 8, "help": [0, 1, 3, 5, 6, 7, 8, 9, 14, 16, 17, 18, 19], "write": [0, 5, 8, 16, 17], "code": [8, 12, 13], "In": 8, "spite": 8, "ar": [0, 1, 2, 3, 5, 7, 8, 10, 11, 12, 13, 14, 20, 22], "respons": 8, "entireti": 8, "result": [2, 3, 5, 6, 7, 8, 13, 16], "calcul": [0, 1, 3, 6, 7, 8, 16], "here": [4, 8], "make": [3, 5, 6, 7, 8, 12, 13, 14, 15, 16, 17, 18, 19, 22], "extens": 8, "gnu": 8, "parallel": [8, 10, 12, 16, 17], "tang": 8, "2011": 8, "softwar": [8, 12], "python": [3, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 17, 18, 19], "environ": [8, 12], "configur": [0, 2, 5, 8], "conda": [8, 12], "git": [8, 12], "sphinx": [8, 12], "note": [8, 13], "appear": 8, "list": [2, 3, 6, 7, 8, 14], "doe": [8, 9], "mean": [0, 3, 6, 7, 8, 9, 11, 13, 14, 16, 19], "person": 8, "organis": [], "name": [2, 3, 6, 7, 8, 9, 12, 14, 16, 17, 18], "endors": 8, "agre": 8, "ani": [0, 5, 8], "even": 8, "know": [8, 12, 14], "its": [3, 6, 7, 8, 13], "exist": [8, 15, 16, 17], "choos": [3, 5, 6, 7, 18], "access": [10, 20], "project": [8, 12, 20, 22], "design": [1, 4, 12, 13], "easi": [11, 12], "everyth": [3, 4, 6, 7, 12, 20], "involv": 12, "kept": 12, "under": [5, 12, 13, 14], "version": [12, 18], "control": [4, 5, 12], "repositori": 12, "host": 12, "made": [12, 13], "page": [12, 14], "http": 12, "com": 12, "ml_region_shar": 12, "contain": [12, 14], "you": [2, 7, 12, 14], "need": [1, 2, 3, 4, 6, 7, 10, 12, 13, 14], "If": [0, 4, 12, 13], "familiar": 12, "alreadi": [10, 12], "what": [4, 12, 13], "do": [0, 4, 10, 12, 16, 17, 20], "fork": 12, "clone": 12, "d": [2, 3, 6, 7, 9, 12], "prefer": 12, "bother": [11, 12], "can": [0, 2, 4, 5, 7, 10, 12, 13, 14, 16, 17], "whole": [10, 12], "thing": 12, "zip": [0, 2, 12, 14], "file": [0, 1, 2, 5, 9, 11, 12, 14, 16, 17, 20, 22], "As": [4, 12], "well": [12, 13], "some": [1, 12, 14], "setup": 12, "necessari": [12, 16, 17], "run": [0, 1, 3, 5, 10, 12, 16, 17], "successfulli": 12, "These": [12, 13, 16, 17], "script": [0, 1, 2, 3, 4, 6, 7, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19], "where": [0, 1, 3, 5, 6, 7, 9, 10, 12, 13, 14, 22], "output": [0, 1, 3, 4, 5, 6, 7, 9, 12, 13, 14], "thei": [1, 12, 13], "reli": [12, 13], "variabl": [0, 3, 6, 7, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20], "scratch": [0, 2, 3, 5, 6, 7, 9, 11, 12, 14, 15, 16, 17, 22], "set": [0, 2, 5, 6, 7, 12, 13, 22], "directori": [1, 4, 5, 9, 12, 14], "plenti": 12, "free": 12, "disc": [10, 12], "space": [0, 1, 4, 12, 13], "onli": [0, 1, 2, 3, 4, 5, 6, 7, 10, 11, 12, 13], "appropri": 12, "avail": [2, 4, 12, 13], "manag": 12, "requir": [3, 5, 6, 7, 9, 12, 14, 16, 17, 18, 19], "which": [12, 22], "specifi": [0, 1, 2, 3, 4, 5, 6, 7, 9, 12, 14], "yaml": 12, "mlrxt": 12, "channel": 12, "default": [1, 3, 5, 6, 7, 9, 14, 16, 17, 18, 19], "forg": 12, "depend": [0, 10, 12], "basic": 12, "3": [0, 2, 3, 4, 6, 7, 9, 12, 14, 18, 19, 22], "9": [0, 12, 14, 22], "libwebp": 12, "iri": [3, 6, 7, 9, 12, 14, 16, 17, 19, 20, 22], "6": [12, 19], "cmocean": [3, 6, 7, 12, 14, 18, 22], "0": [0, 2, 3, 4, 5, 6, 7, 9, 12, 14, 15, 16, 17, 18, 19, 20, 22], "get": [2, 3, 4, 5, 6, 7, 9, 11, 12, 13, 14, 19, 22], "ll": 12, "regist": 12, "see": 12, "cd": [10, 12], "eu": 12, "api": 12, "cdsapi": [9, 11, 12], "build": [12, 20], "diagnost": 12, "have": [1, 2, 9, 11, 12, 13, 14, 16, 17], "gpu": 12, "eigen": 12, "might": 12, "faster": 12, "gpu_py39hd4ae112_0": 12, "option": 12, "formatt": 12, "black": [6, 12, 13, 22], "gener": [1, 2, 3, 5, 6, 7, 12, 13], "7": [2, 3, 6, 7, 12, 14, 19], "monitor": [0, 12], "job": 12, "tmux": 12, "tell": 12, "look": 12, "modul": 12, "root": 12, "A": [8, 12, 13], "hack": 12, "edit": [1, 5, 12], "everi": [4, 5, 9, 12], "instal": 12, "much": [12, 13, 20], "easier": [12, 20], "replac": [1, 12, 19], "path": [3, 5, 6, 7, 9, 11, 12, 14, 15, 16, 17], "your": [1, 12], "pythonpath": 12, "home": 12, "h03": 12, "hadpb": 12, "anaconda": 12, "miniconda": 12, "creat": [2, 4, 12, 14, 16, 17], "activ": [0, 12], "web": 12, "includ": [1, 12, 13, 14], "doc": 12, "restructuredtext": 12, "format": [0, 5, 9, 11, 12, 16, 17], "dummi": 22, "test": [0, 1, 2, 3, 4, 5], "how": [2, 4, 13], "reproduc": 13, "extend": [3, 6, 7, 13], "author": 13, "acknowledg": 13, "crown": 13, "copyright": 13, "2024": [13, 16], "It": 13, "publish": 13, "term": 13, "open": 13, "govern": 13, "licenc": 13, "sourc": [2, 4, 5, 13, 14], "bsd": 13, "panda": 12, "mo": 12, "util": [0, 3, 6, 7, 9, 13, 14, 16, 17, 18, 19, 20], "function": [0, 3, 6, 7, 9, 13, 14, 16, 17, 22], "plot": [1, 2, 6, 7, 10, 11, 13, 14, 18, 19], "re": [11, 13, 22], "grid": [3, 6, 7, 9, 11, 13, 14, 16, 17, 18, 19, 22], "normalis": 16, "fit": [0, 4, 13, 14, 15, 16, 18, 19], "done": [1, 8], "separ": [1, 3, 6, 7, 8], "precipit": [8, 18], "reconstruct": 8, "lot": 8, "share": 8, "io": [2, 14, 16, 17], "_": [], "organ": 8, "normal": [0, 3, 6, 7, 13, 17, 19], "so": [1, 2, 9, 11, 13, 14, 16, 20], "geograph": 20, "longitud": [6, 9, 20, 22], "rang": [0, 2, 3, 5, 6, 7, 9, 15, 16, 17, 19, 20, 22], "180": [3, 6, 7, 9, 20, 22], "25": [3, 6, 7, 18, 19, 20, 22], "degre": [20, 22], "resolut": [11, 16, 17, 20, 22], "regrid": [9, 17, 20, 22], "befor": 20, "defin": [0, 1, 11, 21], "standard": [17, 21], "conveni": [3, 6, 7, 22], "map": [2, 3, 6, 7, 14, 18, 22], "scatter": [3, 6, 7, 13, 22], "colourbar": [], "common": [13, 20], "specif": [0, 1, 2, 3, 5, 6, 7, 20], "": [0, 2, 3, 5, 6, 7, 9, 11, 14, 15, 16, 17, 20, 22], "earli": 20, "import": [0, 2, 3, 4, 5, 6, 7, 9, 11, 14, 15, 16, 17, 18, 19, 20, 22], "numpi": [0, 2, 3, 6, 7, 9, 14, 16, 17, 18, 19, 20, 22], "np": [2, 3, 6, 7, 9, 14, 16, 17, 18, 19, 20, 22], "cube": [9, 16, 17, 19, 20, 22], "analysi": [9, 16, 17, 20, 22], "coord_system": [9, 20, 22], "ident": 20, "except": [2, 3, 6, 7, 9, 20, 22], "cut": 20, "move": 20, "mid": 20, "pacif": 20, "over": [0, 5, 20], "xmin": [20, 22], "xmax": [20, 22], "ymin": [3, 6, 7, 20, 22], "90": [3, 6, 7, 9, 20, 22], "ymax": [3, 6, 7, 20, 22], "pole_latitud": [20, 22], "pole_longitud": [20, 22], "npg_longitud": [20, 22], "c": [9, 11, 20, 22], "rotatedgeogc": [9, 20, 22], "lat_valu": [20, 22], "arang": [20, 22], "latitud": [6, 9, 20, 22], "coord": [9, 20, 22], "dimcoord": [20, 22], "standard_nam": [20, 22], "grid_latitud": [3, 6, 7, 20, 22], "unit": [20, 22], "degrees_north": [20, 22], "lon_valu": [20, 22], "grid_longitud": [3, 6, 7, 20, 22], "degrees_east": [20, 22], "dummy_data": [20, 22], "ma": [3, 6, 7, 14, 16, 17, 20, 22], "maskedarrai": [14, 16, 17, 20], "zero": [0, 14, 20, 22], "len": [2, 3, 4, 6, 7, 9, 20, 22], "fals": [0, 2, 3, 4, 5, 6, 7, 9, 14, 15, 16, 17, 18, 19, 20], "e5scub": [3, 6, 7, 14, 16, 17, 18, 20], "dim_coords_and_dim": [20, 22], "e5sc": 20, "o": [0, 2, 3, 5, 6, 7, 9, 11, 14, 15, 16, 17, 18, 19, 22], "matplotlib": [3, 6, 7, 14, 18, 19, 22], "patch": [3, 6, 7, 14, 18, 19, 22], "rectangl": [3, 6, 7, 14, 18, 19, 22], "line": [3, 6, 7, 19, 22], "line2d": [3, 6, 7, 19, 22], "care": 22, "about": [3, 6, 7, 10, 13, 22], "datum": 22, "futur": [9, 22], "datum_support": [9, 22], "true": [0, 2, 3, 4, 6, 7, 9, 11, 14, 15, 16, 17, 18, 19, 22], "pole": 22, "locat": [13, 14, 16, 18, 19, 22], "assum": 22, "equirectangular": 22, "def": [0, 2, 3, 5, 6, 7, 9, 14, 15, 16, 17, 19, 22], "extract_pol": 22, "try": [3, 6, 7, 22], "lat": 22, "none": [0, 2, 3, 4, 5, 6, 7, 9, 14, 16, 17, 18, 19, 22], "return": [0, 2, 3, 5, 6, 7, 9, 14, 15, 16, 17, 19, 22], "grid_mapping_nam": 22, "rotated_latitude_longitud": 22, "grid_north_pole_latitud": 22, "grid_north_pole_longitud": 22, "north_pole_grid_longitud": 22, "els": [0, 2, 3, 4, 6, 7, 18, 22], "print": [0, 3, 4, 5, 6, 7, 9, 15, 16, 17, 22], "unsupport": [2, 22], "coordin": 22, "extract": [3, 6, 7, 9, 19, 22], "take": [2, 6, 7, 10, 13, 14, 16, 17, 22], "argument": [6, 7, 14, 16, 17, 22], "plot_cub": 22, "high": [11, 22], "land": [10, 22], "mask": [0, 1, 3, 4, 6, 7, 9, 10, 13, 14, 16, 17, 22], "get_land_mask": 22, "grid_cub": 22, "lm": 22, "load_cub": [9, 14, 16, 22], "fixed_field": [], "land_mask": [9, 10, 11, 22], "opfc_global_2019": [], "nc": [9, 11, 14, 15, 16, 22], "getenv": [0, 2, 3, 5, 6, 7, 9, 11, 14, 15, 16, 17, 22], "datadir": [], "linear": 22, "suppli": 22, "ax": [3, 6, 7, 14, 19, 22], "plotfieldax": [3, 6, 7, 14, 18, 22], "ax_map": 22, "field": [0, 3, 4, 5, 6, 7, 13, 22], "vmax": [3, 6, 7, 18, 22], "vmin": [3, 6, 7, 18, 22], "lmask": 22, "cmap": [3, 6, 7, 14, 18, 22], "cm": [3, 6, 7, 14, 18, 22], "balanc": [3, 6, 7, 14, 18, 22], "plotcub": 22, "f_alpha": 22, "show_land": 22, "max": [3, 6, 7, 19, 22], "compress": [18, 22], "min": [2, 3, 6, 7, 14, 22], "lon": 22, "point": [0, 9, 15, 19, 22], "coordinatenotfounderror": 22, "set_ylim": [3, 6, 7, 22], "set_xlim": [3, 6, 7, 22], "set_axis_off": [3, 6, 7, 14, 18, 19, 22], "set_aspect": 22, "equal": 22, "adjust": 22, "box": 22, "anchor": 22, "add_patch": [3, 6, 7, 14, 18, 19, 22], "facecolor": [3, 6, 7, 14, 18, 19, 22], "fill": [3, 6, 7, 14, 18, 19, 22], "zorder": [3, 6, 7, 14, 18, 19, 22], "t_img": 22, "pcolorfast": 22, "alpha": [3, 6, 7, 22], "10": [0, 3, 6, 7, 9, 13, 14, 18, 19, 22], "overlai": 22, "mask_img": 22, "color": [3, 6, 7, 19, 22], "listedcolormap": 22, "4": [0, 2, 3, 6, 7, 14, 19, 22], "100": [3, 6, 7, 13, 14, 18, 19, 22], "provid": [2, 4, 22], "plotscatterax": [3, 6, 7, 22], "var_in": 22, "var_out": 22, "xlabel": 22, "ylabel": 22, "bin": [3, 5, 6, 7, 9, 10, 11, 14, 15, 16, 17, 18, 19, 22], "log": [0, 3, 5, 6, 7, 22], "hexbin": 22, "x": [0, 2, 3, 6, 7, 14, 22], "y": [3, 6, 7, 22], "tool": 22, "crop_by_perc": 22, "ice_r": 22, "5": [0, 2, 3, 4, 6, 7, 14, 16, 18, 19, 22], "gridsiz": 22, "50": [3, 6, 7, 22], "mincnt": 22, "add_lin": [3, 6, 7, 19, 22], "xdata": 22, "ydata": 22, "linestyl": [3, 6, 7, 22], "solid": 22, "linewidth": [3, 6, 7, 14, 18, 19, 22], "histogram": [19, 22], "plothistax": [18, 19, 22], "var": [9, 22], "hist": 22, "blue": [3, 22], "densiti": 22, "There": [20, 22], "one": [0, 1, 3, 4, 6, 7, 9, 10, 13, 14, 16, 17, 20], "user": [20, 22], "target": [0, 3, 6, 7, 13, 20], "three": [3, 6, 7, 14, 22], "callabl": 22, "colourmap": [3, 6, 7, 22], "given": [14, 22], "scatterplot": [6, 22], "two": [0, 3, 6, 7, 13, 22], "we": [0, 1, 2, 4, 10, 11, 13, 14], "monthli": [2, 9, 10, 11, 13, 16, 17, 18, 22], "averag": [2, 5, 9, 10, 13], "surfac": 10, "four": 10, "2m_temperatur": [4, 9, 10, 15, 18], "sea_surface_temperatur": [9, 10, 14, 15], "mean_sea_level_pressur": [9, 10, 14, 15, 18], "total_precipit": [9, 10, 14, 15, 16, 17, 18, 19], "also": [10, 13], "want": [1, 10, 11], "sea": [10, 14], "month": [1, 2, 3, 4, 9, 10, 11, 14, 15, 16, 17, 18, 19], "awesom": 10, "8gb": 10, "few": [10, 13], "hour": 10, "usr": [3, 5, 6, 7, 9, 10, 11, 14, 15, 16, 17, 18, 19], "bash": 10, "retriev": [9, 10, 11], "Will": 10, "load": [0, 2, 3, 5, 6, 7, 9, 10, 14, 16, 17, 18, 19], "get_data_for_period_era5": 10, "py": [0, 2, 3, 4, 5, 6, 7, 9, 10, 15, 16, 17], "j": 10, "get_land_mask_from_era5_land": 10, "realli": [9, 11], "understand": 9, "rid": 9, "error": [0, 9], "messag": [3, 6, 7, 9], "explicit": 9, "coodin": 9, "system": 9, "add": [1, 9, 14], "properli": 9, "cs_era5": 9, "And": [0, 1, 9, 13], "place": 9, "add_coord_system": 9, "cbe": 9, "year": [2, 3, 4, 6, 7, 9, 11, 13, 14, 16, 17, 18, 19], "constraint": [3, 6, 7, 9], "varc": 9, "2020": 9, "must": 9, "fname": [2, 9], "04d": [0, 2, 3, 5, 6, 7, 9, 16, 17], "isfil": [9, 11], "No": [3, 6, 7, 9], "ftt": 9, "time": [1, 2, 3, 5, 7, 9, 11, 13, 14], "lambda": [3, 6, 7, 9, 14], "cell": [3, 6, 7, 9, 11, 19], "unnecessari": 9, "height": [9, 19], "dimens": [0, 9], "shape": [0, 4, 9, 14, 16, 18, 19], "expver": 9, "long_nam": 9, "nearest": 9, "load_climatologi": [], "climatologi": 0, "s_": [], "02d": [2, 3, 6, 7, 14, 15, 16, 17, 19], "load_sd_climatologi": [], "sd_climatologi": [], "sd": 16, "env": [3, 5, 6, 7, 9, 11, 14, 15, 16, 17, 18, 19], "argpars": [3, 5, 6, 7, 9, 14, 16, 17, 18, 19], "parser": [3, 5, 6, 7, 9, 14, 16, 17, 18, 19], "argumentpars": [3, 5, 6, 7, 9, 14, 16, 17, 18, 19], "add_argu": [3, 5, 6, 7, 9, 14, 16, 17, 18, 19], "type": [3, 5, 6, 7, 9, 14, 16, 17, 18, 19], "str": [3, 6, 7, 9, 14, 16, 17, 18, 19], "int": [2, 3, 5, 6, 7, 9, 14, 16, 17, 18, 19], "opdir": [9, 11, 14], "arg": [0, 3, 5, 6, 7, 9, 14, 16, 17, 18, 19], "parse_arg": [3, 5, 6, 7, 9, 14, 16, 17, 18, 19], "isdir": [5, 9, 11, 14, 16, 17], "makedir": [5, 9, 11, 14, 16, 17], "exist_ok": [9, 11, 14], "ctrlb": [9, 11], "netcdf": [9, 11, 16, 17], "product_typ": [9, 11], "monthly_averaged_reanalysi": [9, 11], "01": [3, 6, 7, 9, 14], "02": [9, 14, 18], "03": [9, 11, 18, 19], "04": 9, "05": [9, 18, 19], "06": 9, "07": [3, 6, 7, 9], "08": 9, "09": 9, "11": [4, 9], "12": [0, 3, 6, 7, 9, 14, 19], "00": [9, 11], "client": [9, 11], "singl": [0, 1, 3, 6, 9, 16, 17], "level": 9, "sever": 9, "startyear": [2, 4, 6, 9, 14, 19], "1940": [9, 17], "endyear": [2, 4, 6, 9, 14, 19], "2023": 9, "opfil": [9, 16, 17], "get_year_of_monthlies_from_era5": 9, "fine": 11, "soil": 11, "temperatur": [11, 13, 14, 15, 18, 19], "just": 11, "wai": [11, 13], "date": [2, 3, 6, 7, 11, 14], "arbitrari": [4, 11], "someth": 11, "soil_temperature_level_1": 11, "2001": 11, "gamma": [0, 4, 14, 15, 16, 18], "top": [3, 6, 7, 13, 14, 15, 18], "bottom": [3, 6, 7, 13, 14, 15, 18], "scale": [3, 14, 16, 18, 19], "calendar": 14, "taken": [0, 14], "tf": [0, 3, 4, 5, 6, 7, 14, 19], "tensor": [2, 3, 6, 7, 14], "dataset": [1, 4, 5, 6, 7, 14, 16, 17], "raw": [14, 15, 16, 18, 19], "dure": 14, "process": [13, 14], "present": 14, "produc": [13, 14], "figur": [3, 6, 7, 13, 14, 18, 19], "equival": [15, 18], "assembl": 15, "valid": [1, 2, 3, 5, 13, 14, 15], "select": [15, 16, 17, 18, 19], "estim": 15, "paramet": [1, 4, 5, 15, 16], "To": [1, 4, 5, 16, 17], "effici": [13, 16, 17], "reformat": [16, 17], "consist": [1, 16, 17], "reassembl": [16, 17], "precalcul": 16, "call": [0, 3, 6, 7, 16, 17], "anoth": [1, 13, 16, 17], "convert": [0, 14, 16, 17], "between": [1, 16, 17], "random": [0, 2, 7, 14, 19], "march": 19, "squeez": [3, 6, 7, 14, 22], "flatten": [3, 6, 7, 22], "is_mask": 22, "find": [2, 14, 16], "optimum": 14, "moment": 14, "sy": [2, 3, 5, 6, 7, 14, 17, 18, 19], "makedataset": [5, 6, 7, 14, 19], "getdataset": [2, 5, 6, 7, 14, 19], "start": [4, 14, 19], "1850": 14, "end": [4, 13, 14, 19], "2050": 14, "mlp": [2, 14, 15, 16, 17], "spi_monthli": [14, 15, 16], "era5_tf_mm": [4, 14, 15, 16], "through": [3, 6, 7, 14], "each": [0, 2, 3, 5, 6, 7, 14, 19], "trainingdata": [5, 14, 19], "cach": [2, 14, 19], "blur": 14, "0e": 14, "batch": [0, 5, 6, 7, 14, 19], "721": [0, 2, 14, 19], "1440": [0, 2, 4, 14, 19], "dtype": 14, "float32": [2, 14, 16, 17], "count": [14, 15, 17], "math": [0, 14], "is_nan": 14, "enough": [2, 13, 14], "nan": [14, 17], "again": 14, "now": 14, "varianc": [0, 3, 6, 7, 14], "logical_and": [14, 16], "squared_differ": [0, 14], "artifici": 14, "expand": 14, "ic": 14, "sst": 14, "273": 14, "fg_locat": 14, "sqrt": 14, "fg_scale": 14, "fg_shape": 14, "copi": [1, 3, 4, 5, 6, 7, 14, 16, 17], "isnan": [14, 17], "save": [0, 4, 5, 14], "shape_m": [14, 15, 16], "location_m": [14, 16], "scale_m": [14, 16], "pre": [2, 14, 16], "prepar": 14, "load_tensor": [2, 14], "file_nam": [2, 14], "sict": [2, 14, 16, 17], "read_fil": [2, 14], "imt": [2, 14], "parse_tensor": [2, 14], "reshap": [2, 14], "filenam": [2, 3, 6, 7, 14], "getfilenam": [2, 14], "infil": [2, 14], "sort": [2, 3, 6, 7, 14], "listdir": [2, 3, 6, 7, 14], "raw_dataset": [14, 17], "fn": [2, 14, 15, 16, 17], "object": [2, 14], "tn_data": 14, "from_tensor_slic": [2, 14], "constant": [2, 4, 14], "content": [2, 14], "fnfile": 14, "ts_data": 14, "num_parallel_cal": [2, 14], "experiment": [2, 14], "autotun": [2, 14], "nois": 14, "case": [3, 4, 6, 7, 13, 14], "stddev": 14, "togeth": [2, 14], "tz_data": [2, 14], "optimis": [2, 14], "great": [2, 14], "iff": [2, 14], "ram": [2, 14], "prefetch": [2, 14], "For": [4, 5, 7, 14], "backend": [3, 6, 7, 14, 18, 19], "backend_agg": [3, 6, 7, 14, 18, 19], "figurecanvasagg": [3, 6, 7, 14, 18, 19], "figurecanva": [3, 6, 7, 14, 18, 19], "valu": [0, 3, 6, 7, 14, 16, 18, 19], "fig": [3, 6, 7, 14, 18, 19], "figsiz": [3, 6, 7, 14, 18, 19], "dpi": [3, 6, 7, 14, 18, 19], "edgecolor": [3, 6, 7, 14, 18, 19], "frameon": [3, 6, 7, 14, 18, 19], "subplotpar": [3, 6, 7, 14, 18, 19], "tight_layout": [3, 6, 7, 14, 18, 19], "canva": [3, 6, 7, 14, 18, 19], "font": [3, 6, 7, 14, 18, 19], "famili": [3, 6, 7, 14, 18, 19], "san": [3, 6, 7, 14, 18, 19], "serif": [3, 6, 7, 14, 18, 19], "arial": [3, 6, 7, 14, 18, 19], "weight": [0, 3, 4, 5, 6, 7, 14, 18, 19], "size": [2, 3, 4, 6, 7, 14, 18, 19], "20": [0, 3, 6, 7, 14, 18], "rc": [3, 6, 7, 14, 18, 19], "axb": [3, 6, 7, 14, 18, 19], "add_ax": [3, 6, 7, 14, 18, 19], "ax_loc": 14, "68": 14, "8": [3, 6, 7, 14], "31": 14, "location_img": 14, "ax_location_cb": 14, "85": 14, "13": [2, 14, 15, 16, 17], "cb": 14, "colorbar": 14, "right": [3, 6, 7, 13, 14], "orient": 14, "vertic": 14, "fraction": [0, 3, 6, 7, 14], "ax_scal": 14, "345": 14, "scale_img": 14, "ax_scale_cb": 14, "ax_shap": 14, "shape_img": 14, "ax_shape_cb": 14, "savefig": [3, 6, 7, 14, 18, 19], "png": [3, 6, 7, 14, 18, 19], "sdir": [15, 16, 17], "dirnam": [5, 15, 16, 17], "realpath": [15, 16, 17], "__file__": [15, 16, 17], "is_don": [15, 16, 17], "continu": [2, 3, 5, 6, 7, 15, 16, 17], "cmd": [15, 16, 17], "fit_for_month": 15, "normalized_dataset": [2, 16], "tfd": [16, 17], "1950": [16, 19], "make_training_tensor": [16, 17], "read": [16, 17], "serialis": [16, 17], "dask": [16, 17], "extern": [16, 17], "core": [3, 6, 7, 16, 17], "config": [16, 17], "thread": [16, 17], "set_inter_op_parallelism_thread": [16, 17], "schedul": [16, 17], "tensor_util": [3, 6, 7, 16, 17], "load_raw": [16, 17], "raw_to_tensor": [16, 17], "integ": [16, 17], "standardis": [2, 16, 17], "qd": [16, 17], "ict": [16, 17], "debug": [0, 16], "check_numer": 16, "bad": [2, 16], "serialize_tensor": [16, 17], "write_fil": [16, 17], "manipul": [16, 17], "get_data": [16, 17, 18], "era5_monthli": [16, 17, 18], "normalize_cub": [16, 18], "unnormalize_cub": 16, "load_fit": [16, 18, 19], "norm": 16, "convert_to_tensor": [16, 17], "tensor_to_cub": [3, 6, 7, 16, 17], "tensor_to_raw": 16, "scipi": [16, 18, 19], "stat": [3, 6, 7, 16, 18, 19], "1969": 18, "actual": 18, "colour": 18, "base": [1, 3, 6, 7, 13, 16, 18], "rain": 18, "tarn": [3, 6, 7, 18], "diff": [3, 6, 7, 18], "ax_raw": 18, "515": 18, "607": 18, "455": 18, "percentil": 18, "95": [3, 6, 7, 18], "ax_hist_raw": 18, "683": 18, "535": 18, "303": 18, "435": 18, "ax_norm": 18, "ax_hist_norm": 18, "sampl": [0, 2, 3, 19], "rng": 19, "default_rng": 19, "2022": [17, 19], "epoch": [0, 3, 4, 5, 6, 7, 19], "show": [6, 13, 19], "random_i": 19, "choic": [13, 19], "random_j": 19, "append": [2, 6, 19], "curv": 19, "m_valu": 19, "m_fit": 19, "x_min": 19, "std": 19, "x_max": 19, "linspac": 19, "num": 19, "pdf": [0, 19], "loc": [16, 19], "15": [3, 6, 7, 19], "200": 19, "make_ax": 19, "sample_i": 19, "x_i": 19, "y_i": 19, "xmargin": 19, "ymargin": 19, "width": 19, "x_offset": 19, "y_offset": 19, "ax_sampl": 19, "araw": 19, "red": [3, 6, 13, 19], "samples_": 19, "s_m": 19, "spi": 16, "aim": 16, "almost": 16, "variat": [0, 1, 5, 13, 16], "match": [4, 16], "cdf": 16, "match_norm": 16, "gamma_p": 16, "norm_mean": 16, "norm_sd": 16, "99999": 16, "caus": 16, "numer": [0, 4, 16], "failur": 16, "00001": 16, "fix": 16, "never": 16, "happen": 16, "ppf": 16, "origin": [6, 13, 16], "match_origin": 16, "same": [0, 2, 4, 13, 16], "most": [13, 16], "miss": [0, 3, 6, 7, 16], "member": [2, 4, 17], "deep": [0, 1, 13], "convolut": [0, 1, 5, 13], "autoencod": [0, 1, 2, 3, 4, 5, 6, 7, 13], "input": [0, 1, 3, 4, 5, 6, 7, 13], "hyperparamet": [0, 1, 4], "instruct": [0, 2, 4], "class": 0, "dcvae": [0, 5, 6, 7, 13], "kera": [0, 4], "initialis": 0, "up": [0, 5, 6, 13], "instanc": 0, "__init__": 0, "self": 0, "super": 0, "encod": [0, 3, 6, 7, 13], "latent": [0, 1, 4, 13], "sequenti": 0, "layer": [0, 1, 13], "inputlay": 0, "input_shap": 0, "ninputchannel": [0, 4], "conv2d": 0, "filter": 0, "kernel_s": 0, "stride": 0, "pad": [0, 3, 6, 7], "elu": 0, "40": 0, "23": 0, "conv2dtranspos": 0, "output_pad": 0, "noutputchannel": [0, 3, 4, 6, 7], "metric": [0, 4, 5], "loss": [0, 3, 5, 6, 7], "train_rms": [0, 3, 6, 7], "trainabl": 0, "train_rmse_m": 0, "train_logpz": [0, 3, 6, 7], "train_logqz_x": [0, 3, 6, 7], "train_logpz_g": 0, "train_logqz_g": 0, "train_loss": [0, 3, 6, 7], "test_rms": [0, 3, 6, 7], "test_rmse_m": 0, "test_logpz": [0, 3, 6, 7], "test_logqz_x": [0, 3, 6, 7], "test_logpz_g": 0, "test_logqz_g": 0, "test_loss": [0, 3, 6, 7], "regular": [0, 3, 4, 6, 7], "regularization_loss": [0, 3, 6, 7], "exampl": [0, 13], "logvar": 0, "split": [0, 2, 3, 6, 7], "num_or_size_split": 0, "axi": [0, 3, 4, 6, 7], "reparameter": 0, "exp": 0, "z": [0, 3, 6, 7], "full": 0, "vae": [0, 1], "calcult": 0, "n": [0, 3, 4, 6, 7], "log_normal_pdf": 0, "raxi": 0, "log2pi": 0, "141592653589793": 0, "reduce_sum": 0, "fit_loss": 0, "reduct": 0, "compar": [0, 3], "keep": [0, 4], "last": [0, 6], "differ": [0, 1, 13], "skill": [0, 13], "guess": 0, "seper": 0, "compon": [0, 3, 6, 7, 13], "kld": 0, "updat": [0, 5], "sum": [0, 3, 6, 7], "compute_loss": 0, "gv": 0, "cv": 0, "tv": 0, "fit_metr": 0, "logpz": [0, 3, 6, 7], "reduce_mean": 0, "beta": [0, 4], "logqz_x": [0, 3, 6, 7], "logpz_g": 0, "61": 0, "logqz_g": 0, "reduce_std": 0, "add_n": 0, "gradient": 0, "train_on_batch": [0, 5], "optim": [0, 4, 5, 13], "gradienttap": 0, "tape": 0, "loss_valu": 0, "overall_loss": 0, "rmse": 0, "trainable_vari": 0, "clip": 0, "against": 0, "sudden": 0, "problem": [0, 13], "maxgradi": [0, 4], "clip_by_norm": 0, "g": 0, "apply_gradi": 0, "update_metr": [0, 5], "traind": 0, "testd": 0, "assign": 0, "validation_batch_count": 0, "area": 0, "trainingmask": [0, 3, 4, 5, 6, 7], "mbatch": [0, 5], "per_replica_loss": 0, "strategi": [0, 4, 5, 7], "batch_loss": 0, "reduc": [0, 1], "reduceop": 0, "assign_add": 0, "unmask": 0, "test_batch_count": 0, "updatelogfil": [0, 5], "logfile_writ": [0, 5], "as_default": [0, 5], "summari": [0, 3, 5, 6, 7], "step": [0, 3, 5, 6, 7], "train_rmse_mask": [0, 3, 6, 7], "scalar": [0, 3, 6, 7], "test_rmse_mask": [0, 3, 6, 7], "out": [0, 2, 3, 6, 7], "printstat": [0, 5], "3f": 0, "outputnam": [0, 3, 4, 5, 6, 7], "initi": 0, "getmodel": [0, 5, 6, 7], "instanti": [0, 4, 5], "restart": [0, 5], "weights_dir": 0, "mle": [0, 3, 5, 6, 7], "epoch_": [0, 5], "modelnam": [0, 3, 4, 5], "load_statu": 0, "load_weight": 0, "ckpt": [0, 5], "expect_parti": 0, "assert_existing_objects_match": 0, "our": 1, "minim": 1, "number": [1, 13], "allow": 1, "properti": 1, "independ": [1, 13], "entir": 1, "dens": 1, "previous": 1, "vector": 1, "ha": [1, 3, 6, 7, 13], "been": [1, 13], "addit": 1, "weak": 1, "abil": 1, "transfer": [1, 13], "inform": 1, "flow": 1, "modif": 1, "new": [1, 4, 5], "suit": 1, "Then": [1, 4, 5], "success": 1, "histori": [1, 6, 7], "training_histori": 1, "seri": [1, 3, 7, 13], "ima": 2, "fni": 2, "concat": [2, 4], "mani": [2, 4, 13], "getdataavail": 2, "dir": 2, "afil": 2, "firstyr": 2, "3000": 2, "lastyr": 2, "maxcount": 2, "filesym": 2, "kei": [2, 3, 6, 7, 13], "purpos": [2, 5, 6, 7], "testsplit": [2, 4], "maxtrainingmonth": [2, 4], "maxtestmonth": [2, 4], "correlatedensembl": [2, 4], "maxensemblecombin": [2, 4], "alwai": [1, 2], "repeat": [2, 5], "multipl": 2, "ensembl": [2, 4], "amonth": 2, "rep": 2, "mnth": 2, "smnth": 2, "break": [2, 3, 6, 7], "05d": 2, "test_n": 2, "elif": [2, 3, 6, 7], "order": [2, 13], "limit": [1, 2, 13], "maximum": [2, 3, 6], "valueerror": 2, "inputtensor": [2, 4], "tnidata": 2, "tsidata": 2, "outputtensor": [2, 4], "e": 2, "outfil": 2, "tnodata": 2, "tsodata": 2, "traincach": [2, 4], "testcach": [2, 4], "darker": 3, "lighter": 3, "plot_training_progress": 3, "progress": [3, 5], "ml_model": [3, 5, 6, 7], "all_convolut": [3, 4, 5, 6, 7], "gmutil": [3, 6, 7], "loadhistori": [3, 6, 7], "plottrainingmetr": [3, 6, 7], "getlogg": [3, 6, 7], "font_manag": [3, 6, 7], "disabl": [3, 6, 7], "comparison": [3, 7], "selfc": 3, "rscale": [3, 6, 7], "rm": [3, 6, 7], "float": [3, 6], "minimum": [3, 6], "max_epoch": [3, 6, 7], "ht": [3, 6, 7], "cht": [3, 6, 7], "cymax": 3, "cymin": 3, "cepoch": 3, "webp": [3, 6, 7], "aymax": [3, 6, 7], "datetim": [3, 6, 7], "event_pb2": [3, 6, 7], "framework": [3, 6, 7], "stai": [3, 6, 7], "becom": [3, 6, 7], "listifi": [3, 6, 7], "isinst": [3, 6, 7], "iter": [3, 6, 7], "typeerror": [3, 6, 7], "tensorboard": [3, 6, 7], "lsc": [3, 6, 7], "offset": [3, 6, 7], "summary_dir": [3, 6, 7], "rfile": [3, 6, 7], "getmtim": [3, 6, 7], "join": [3, 6, 7], "serialized_record": [3, 6, 7], "tfrecorddataset": [3, 6, 7], "srecord": [3, 6, 7], "event": [3, 6, 7], "fromstr": [3, 6, 7], "makendarrai": [3, 6, 7], "tag": [3, 6, 7], "1000000": [3, 6, 7], "n_epoch": [3, 6, 7], "utf": [3, 6, 7], "ab": [3, 6, 7], "get_cmap": [3, 6, 7], "prate": [3, 6, 7], "precip": [3, 5, 6, 7], "mslp": [3, 6, 7], "plotvalidationfield": [3, 6, 7], "nfield": [3, 6, 7], "figscal": [3, 6, 7], "wratio": [3, 6, 7], "row": [3, 6, 7], "own": [3, 6, 7], "subfigur": [3, 6, 7], "subfig": [3, 6, 7], "wspace": [3, 6, 7], "vari": [3, 6, 7], "ax_var": [3, 6, 7], "subplot": [3, 6, 7], "nrow": [3, 6, 7], "ncol": [3, 6, 7], "width_ratio": [3, 6, 7], "left": [3, 6, 7, 13], "varx": [3, 6, 7], "masked_wher": [3, 6, 7], "set_titl": [3, 6, 7], "x_img": [3, 6, 7], "third": [3, 6, 7], "set_xtick": [3, 6, 7], "75": [3, 6, 7], "set_ytick": [3, 6, 7], "varxm": [3, 6, 7], "varym": [3, 6, 7], "mflat": [3, 6, 7], "fourth": [3, 6, 7], "plain": [3, 6, 7], "background": [3, 6, 7], "addlin": [3, 6, 7], "dta": [3, 6, 7], "col": [3, 6, 7], "idx": [3, 6, 7], "dtp": [3, 6, 7], "dta2": [3, 6, 7], "exit": [3, 6, 7], "arrai": [3, 6, 7], "overal": [3, 6, 7], "kl": [3, 4, 6, 7], "diverg": [3, 4, 6, 7], "main": [3, 6, 7], "ymaxl": [3, 6, 7], "subplots_adjust": [3, 6, 7], "ax_loss": [3, 6, 7], "auto": [3, 6, 7], "set_ylabel": [3, 6, 7], "set_xlabel": [3, 6, 7], "comp_font_s": [3, 6, 7], "nvar": [3, 6, 7], "layout": [3, 6, 7], "b": [3, 6, 7], "subplotlayout": [3, 6, 7], "found": [3, 6, 7], "ax_rms": [3, 6, 7], "sharex": [3, 6, 7], "sharei": [3, 6, 7], "item": [3, 6, 7], "fontsiz": [3, 6, 7], "tick_param": [3, 6, 7], "labels": [3, 6, 7], "ax_kld": [3, 6, 7], "yminl": [3, 6, 7], "21": [3, 6, 7], "statist": [3, 6, 7], "computescalarstat": [3, 6, 7], "min_lat": [3, 6, 7], "max_lat": [3, 6, 7], "min_lon": [3, 6, 7], "max_lon": [3, 6, 7], "datestr": [3, 6, 7], "string": [3, 6, 7], "sep": [3, 6, 7], "pass": [3, 6, 7], "field_to_scalar": [3, 6, 7], "coord_valu": [3, 6, 7], "s_mask": [3, 6, 7], "plotscalarstat": [3, 6, 7], "all_stat": [3, 6, 7], "multi": [3, 6, 7], "300": [3, 6, 7], "14": [3, 6, 7], "plot_var": [3, 6, 7], "sfig": [3, 6, 7], "m": [3, 6, 7], "label": [3, 6, 7], "var_ax": [3, 6, 7], "ypad": [3, 6, 7], "first": [3, 6, 7], "subaxi": [3, 6, 7], "timedelta": [3, 6, 7], "dai": [3, 6, 7, 13], "va": [3, 6, 7], "bbox": [3, 6, 7], "dict": [3, 6, 7], "boxstyl": [3, 6, 7], "squar": [3, 6, 7], "fc": [3, 6, 7], "60": [3, 6, 7], "second": [3, 6, 7], "vname": [3, 6, 7], "modifi": 4, "far": 4, "possibl": 4, "spec": 4, "t2m": 4, "printout": 4, "period": 4, "back": 4, "less": 4, "than": 4, "combin": 4, "larg": 4, "nmonthsinepoch": 4, "length": 4, "onc": 4, "nepoch": [4, 5], "250": [4, 6, 7], "shufflebuffers": [4, 5, 7], "1000": 4, "buffer": 4, "shuffl": [4, 5, 7], "batchsiz": [4, 5], "32": 4, "001": 4, "factor": 4, "000": [4, 13], "instabl": 4, "protect": 4, "printinterv": [4, 5], "often": 4, "mirroredstrategi": 4, "adam": 4, "1e": 4, "encoder_act": 4, "encoder_kernel": 4, "generator_act": 4, "generator_kernel": 4, "subset": [4, 13], "nh": [4, 13], "360": 4, "361": 4, "validate_multi": [5, 6], "autoencodermodel": [5, 6, 7], "them": 5, "experimental_distribute_dataset": 5, "validationdata": 5, "testdata": 5, "scope": 5, "logfil": 5, "log_fn": 5, "create_file_writ": 5, "state": [5, 13], "report": 5, "start_tim": 5, "per_replica_op": 5, "end_training_tim": 5, "accumul": 5, "save_dir": 5, "save_weight": 5, "end_monitoring_tim": 5, "global": [6, 13], "By": [6, 7], "dest": 6, "action": [6, 7], "store_tru": [6, 7], "hand": [7, 13], "column": [7, 13], "get_strategi": 7, "simpl": 7, "desir": 7, "structur": 13, "explicitli": 1, "indic": 1, "give": 1, "u": 1, "northern": [1, 13], "hemispher": [1, 13], "without": [3, 7], "next": 7, "panel": [6, 13], "major": 13, "challeng": 13, "applic": 13, "machin": 13, "learn": 13, "decorrel": 13, "atmospher": 13, "per": 13, "total": 13, "best": 13, "ten": 13, "smaller": 13, "world": 13, "observ": 13, "decad": 13, "describ": 13, "method": 13, "appli": 13, "form": 13, "southern": 13, "sh": 13, "2m": 13, "veri": 13, "low": 13, "convent": 13, "mix": 13, "fulli": 13, "connect": 13, "obviou": 13, "spatial": 13, "pattern": 13, "But": 13, "becaus": 13, "restrict": 13, "themselv": 13, "expect": 13, "haven": 13, "built": 13, "inspir": 13, "stabl": 13, "diffus": 13, "decod": 13, "3d": 13, "detail": 13, "still": 13, "evalu": 13, "abov": 13, "better": 13, "generaliz": 13, "scheme": 13, "homogen": 13, "across": 13, "globe": 13, "essenti": 13, "abl": 13}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"A": 1, "flexibl": [], "machin": [], "learn": [], "model": [0, 1, 3, 4, 5, 6, 7, 13], "data": [2, 7, 9, 10, 14, 15, 16, 17, 18, 19], "transform": [], "author": 8, "acknowledg": 8, "monthli": [], "dataset": 2, "histor": [], "precipit": [], "how": 12, "reproduc": 12, "extend": 12, "thi": 12, "work": 12, "region": [1, 2, 3, 5, 6, 7, 13], "cross": [1, 2, 3, 5, 6, 7, 13], "train": [3, 5, 6, 7, 13, 15], "ml": 13, "climat": 13, "small": 13, "print": 13, "util": [21, 22], "function": 21, "plot": [3, 21, 22], "re": 21, "grid": [20, 21], "appendic": 13, "normalis": [], "fit": [], "defin": 20, "standard": 20, "get": 10, "us": 10, "era5": [9, 14, 16, 17, 18, 19], "download": [9, 11], "access": 9, "land": 11, "mask": 11, "estim": 14, "normal": [14, 15, 16, 18], "paramet": 14, "assembl": [16, 17], "set": [16, 17], "tf": [2, 16, 17], "tensor": [16, 17], "raw": 17, "check": [18, 19], "gamma": 19, "distribut": 19, "gener": [0, 4], "fix": 0, "structur": [0, 1], "common": 1, "all": [1, 6], "locat": 1, "make": 2, "input": 2, "output": 2, "dcvae": 2, "histori": 3, "specif": 4, "file": 4, "script": 5, "valid": [6, 7], "time": 6, "seri": 6, "test": [6, 7], "month": [6, 7], "singl": 7}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"Authors and acknowledgements": [[8, "authors-and-acknowledgements"]], "ERA5 data download and access": [[9, "era5-data-download-and-access"]], "Get the data to be used": [[10, "get-the-data-to-be-used"]], "Land mask download": [[11, "land-mask-download"]], "How to reproduce and extend this work": [[12, "how-to-reproduce-and-extend-this-work"]], "Define a standard grid": [[20, "define-a-standard-grid"]], "Utility functions for plotting and re-gridding": [[21, "utility-functions-for-plotting-and-re-gridding"]], "Plotting utilities": [[22, "plotting-utilities"]], "Estimate normalization parameters for ERA5 data": [[14, "estimate-normalization-parameters-for-era5-data"]], "Normalizing training data": [[15, "normalizing-training-data"]], "Check normalization of ERA5 data": [[18, "check-normalization-of-era5-data"]], "Check gamma distributions for ERA5 data": [[19, "check-gamma-distributions-for-era5-data"]], "Assemble ERA5 normalized data into a set of tf.tensors": [[16, "assemble-era5-normalized-data-into-a-set-of-tf-tensors"]], "Assemble ERA5 raw data into a set of tf.tensors": [[17, "assemble-era5-raw-data-into-a-set-of-tf-tensors"]], "Generic model fixed structure": [[0, "generic-model-fixed-structure"]], "Make the tf.data.Dataset inputs and outputs for the cross-region DCVAE": [[2, "make-the-tf-data-dataset-inputs-and-outputs-for-the-cross-region-dcvae"]], "Generic model specification file": [[4, "generic-model-specification-file"]], "Cross-region model training script": [[5, "cross-region-model-training-script"]], "A cross-region model with common structure at all locations": [[1, "a-cross-region-model-with-common-structure-at-all-locations"]], "Cross-region model - plot training history": [[3, "cross-region-model-plot-training-history"]], "Cross-region model - validate trained model on test data for a single month": [[7, "cross-region-model-validate-trained-model-on-test-data-for-a-single-month"]], "Cross-region model - validate trained model on time-series of all test months": [[6, "cross-region-model-validate-trained-model-on-time-series-of-all-test-months"]], "Regional cross-training in ML climate models": [[13, "regional-cross-training-in-ml-climate-models"]], "Appendices": [[13, "appendices"]], "Small print": [[13, "small-print"]]}, "indexentries": {}})